Hydrometeorological variables predict fecal
indicator bacteria densities in freshwater:
data-driven methods for variable selection
Rachael M. Jones, Li Liu & Samuel
Dorevitch

Environmental Monitoring and
Assessment
An International Journal Devoted to
Progress in the Use of Monitoring Data
in Assessing Environmental Risks to
Man and the Environment
ISSN 0167-6369
Volume 185
Number 3
Environ Monit Assess (2013)
185:2355-2366
DOI 10.1007/s10661-012-2716-8

1 23



Your article is protected by copyright and
all rights are held exclusively by Springer
Science+Business Media B.V.. This e-offprint
is for personal use only and shall not be selfarchived in electronic repositories. If you
wish to self-archive your work, please use the
accepted author’s version for posting to your
own website or your institution’s repository.
You may further deposit the accepted author’s
version on a funder’s repository at a funder’s
request, provided it is not made publicly
available until 12 months after publication.

1 23



Author's personal copy
Environ Monit Assess (2013) 185:2355–2366
DOI 10.1007/s10661-012-2716-8

Hydrometeorological variables predict fecal indicator bacteria
densities in freshwater: data-driven methods for variable selection
Rachael M. Jones & Li Liu & Samuel Dorevitch

Received: 27 March 2012 / Accepted: 4 June 2012 / Published online: 27 June 2012
# Springer Science+Business Media B.V. 2012

Abstract Statistical models of microbial water quality
inform risk management for water recreation. Current
research focuses on resource-intensive, locationspecific data collection and water quality modeling,
but this approach may be cost-prohibitive for risk
managers responsible for numerous recreation sites.
As an alternative, we tested the ability of two datadriven models, tree regression and random forests with
conditional inference trees, to select readily available
hydrometeorological variables for use in linear mixed
effects (LME) models predicting bacterial density. The
Electronic supplementary material The online version of this
article (doi:10.1007/s10661-012-2716-8) contains supplementary
material, which is available to authorized users.
R. M. Jones (*) : S. Dorevitch
Division of Environmental and Occupational Health
Sciences, School of Public Health,
University of Illinois at Chicago,
2121 W Taylor St.,
Chicago, IL 60612, USA
e-mail: rjones25@uic.edu
L. Liu : S. Dorevitch
Division of Epidemiology and Biostatistics,
School of Public Health, University of Illinois at Chicago,
1603 W Taylor St.,
Chicago, IL 60612, USA
S. Dorevitch
Institute for Environmental Science and Policy,
University of Illinois at Chicago,
2121 W Taylor St.,
Chicago, IL 60612, USA

study included the Chicago Area Waterway System
(CAWS) and Lake Michigan beaches and harbors in
Chicago, Illinois, at which Escherichia coli and
enterococci were measured seasonally in 2007–
2009. Tree regression node variables reduced data
dimensionality by >50 %. Variable importance
ranks from random forests were used in a
forward-step selection based on R2 and root mean
squared prediction error (RMSPE). We found two
to three variables explained bacteria densities
well relative to random forests with all variables.
LME models with tree- or forest-selected variables
performed reasonably well (0.335 < R 2 < 0.658).
LME models for Lake Michigan had good prediction
accuracy with respect to the single sample maximum
standard (72–77 %), but limited sensitivity (23–62 %).
Results suggest that our alternative approach is feasible
and performs similarly to more resource-intensive
approaches.
Keywords Random forests . Combined sewer
overflow . Tree regression . Rainfall .
Fecal indicator bacteria

Introduction
The prediction of microbial water quality is an important
tool for the management of health risks for those who
swim and engage in other water recreation activities.
Statistical models predict and identify factors indicative



Author's personal copy
2356

of high microbial density so that recreators can be
notified of high-risk conditions or remediation efforts
can be targeted (Nevers and Whitman 2005; Maimone
et al. 2007; Frick et al. 2008).
It is increasingly apparent that the physical processes
that determine water quality and the indicators of high
microbial density are location specific. To maximize
local explanatory power, researchers may monitor
numerous potential determinants at a site, such as
wind, near-shore waves, and chemicophysical
measures of water quality (Nevers and Whitman
2005; Nevers and Whitman 2008; Frick et al.
2008). Organizations responsible for water recreation,
however, manage many locations and may not have
resources to deploy instruments to monitor the
environment at all locations. Thus, while such
resource-intensive monitoring contributes significantly
to our understanding of physical processes and
predictions, the utility of models for risk management
of water recreation is limited, if the predictors gleaned
from such monitoring are required for all statistical
prediction of water quality.
Rainfall is one hydrometeorological factor that is
readily available and measured near water recreation
locations, and has consistently been associated with
microbial water quality. Rainfall is widely included in
statistical models of water quality, but it is described in
many ways: total precipitation 4 h, 24 h, 48 h, or 72 h
prior to sample collection (Olyphant and Whitman
2004; Nevers and Whitman 2005; Frick et al. 2008;
Schets et al. 2008; Wong et al. 2009); rainfall in excess
of a threshold in a given time window (Edwards et al.
2003; Eleria and Vogel 2005; Roser et al. 2006;
Maimone et al. 2007); or rainfall approximated by
water flow or height (Roser et al. 2006; Maimone
et al. 2007). Rarely, however, is the rationale for
the selection of a specific rainfall metric or the a
priori selection of variables for inclusion in statistical
models described (Olyphant and Whitman 2004; Nevers
and Whitman 2008).
This research has two objectives. First, we explore
the use of data-driven methods for the selection of
hydrometeorological variables from a suite of closely
related variables important for the prediction of bacterial
density. The data-driven methods tested include tree
regression and random forests. Second, we evaluate
the ability of selected hydrometeorological variables to
predict the microbial quality of recreational water in the
context of linear statistical models. We hypothesize that

Environ Monit Assess (2013) 185:2355–2366

data-driven variable selection can identify effective
predictors from large numbers of correlated variables,
thereby yielding statistical models predictive of bacterial
density. The benefit of the approach is that models built
with readily available data can be applied at more
locations than models requiring resource-intensive
environmental monitoring data. It is not our objective
to explore the physical processes by which hydrometeorological variables determine bacterial density.
Data-driven methods, or algorithm models, uncover
both the structure and strength of relationships between predictor and response variables that are intrinsic to the data by application of an algorithm (Breiman
2001a, b). This contrasts with a data model in which
the strength of relationships between predictor and
response variables are determined in the context of
an assumed structure, e.g., linear regression. Regression
trees and random forests are two related examples of
algorithm models. Random forests is a tree regression
method that fits numerous trees to (bootstrap) samples
of data using randomly selected variables for testing of
tree nodes. The simulation in random forests means that
the model is less sensitive to specific variable values
than single tree regression (Breiman 2001b). Both
methods create predictive models; however, random
forests has the added advantage of identifying the
relative predictive importance of each variable.
Applications of algorithmic models to determine
microbial water quality have been limited. Parkhurst
et al. (2005) used random forests as an exploratory technique to identify the importance of hydrometeorological
variables for predicting Escherichia coli and enterococcal
densities at recreational beaches. Those investigators
presented the five most important variables at several
beaches, demonstrating that variable importance varied
by location. In the context of population ecology,
random forests has been used to predict the abundance
and richness of aquatic and terrestrial species but not to
prioritize predictor variables (Prasad et al. 2006; He et al
2010; Kampichler et al. 2010; Smith et al. 2010; Wie et
al. 2010).
The specific focus of this study is the prediction of
the densities of the bacteria E. coli and enterococci,
which are used as indicators of fecal pollution and
health risk in recreational water (US EPA 1986). Our
analysis includes two classes of water: (i) the Chicago
Area Waterway System (CAWS), a system of channels
engineered for navigation and wastewater disposal but
used for limited-contact water recreation, and (ii) Lake



Author's personal copy
Environ Monit Assess (2013) 185:2355–2366

Michigan harbors and beaches in Chicago designated
for full-contact water recreation (Dorevitch et al.
2012). Though the wastewater load in CAWS makes
the system less relevant to the management of
recreational water quality, it yields numerous predictor
variables and therefore can provide insight into variable
selection strategies.

Methods
Sample strategy and analysis
These data were collected as part of the Chicago
Health, Environmental Exposure and Recreation
Study (CHEERS), a cohort epidemiologic study of
illness associated with limited-contact water recreation
(Dorevitch et al. 2012). Sampling occurred primarily
on weekends in the summers of 2007–2009. Data were
excluded during the period 9/2008–5/2009 owing to
laboratory quality assurance and quality control issues.
The CAWS study locations in the North Branch and
Cal-Sag Channel are influenced by nondisinfected
secondary-treated discharge from water reclamation
plants (aerobic digestion) and periodic overflow from
the combined sewer system. Combined sewer outfalls
are ubiquitous. A subset of CHEERS study locations
was selected for these analyses owing to the relatively
high sampling frequency (Table S1). In the North
Branch, locations A–E are 0.68 km upstream and
3.2, 5.4, 9.1, and 14.6 km downstream of the
Northside Water Reclamation Plant, respectively.
In the Cal-Sag Channel, locations F–H are 4.8,
14.6, and 18.8 km downstream of the Calumet
Water Reclamation Plant, respectively. The Lake
Michigan study locations are four harbors and
three beaches within Chicago that are denoted as
I–O and arranged from north to south. The sample
locations are mapped in Fig. S1 of the supplementary
material. All sample locations are in urban environments.
Grab samples were collected in the upper 10 cm of
water offshore in 2007 and at convenient near-shore
locations in 2008 and 2009. The change in sampling
location was based on findings in 2007 that microbe
densities were similar across the channel width. Water
was sampled every 2 h (one to four times per day) and
analyzed by culture following membrane filtration. E.
coli were enumerated in accordance with EPA Method
1603, with modified membrane thermo-tolerant E. coli

2357

(mTEC) agar. Enterococci were enumerated in accordance with EPA Method 1600, with membraneEnterococcus indoxyl-beta-D-gluocoside (mEI) agar.
Data preparation
Samples with densities below the limit of detection
(LOD) of 1 CFU/100 mL were equated with one-tenth
the LOD. Bacteria densities were log10 transformed to
reduce skewness. Transformed (log10) densities from
split samples were averaged and then all samples
collected in the same hour on the same date and
location were averaged. Averaging the log10 densities
gives the hourly geometric mean, rather than the
arithmetic mean. Summary statistics reported in
Table S1 are based on hourly values and presented
as log10 densities.
Rainfall variables were defined for each location–
day–hour with bacteria densities using hourly rainfall
measured at the nearest gauge(s) by the Illinois State
Water Survey (Table 1). The rain gauge LOD is
0.025 in./h. Rainfall events were distinguished by ≥6 h
without measurable precipitation (Dunkerley 2008).
Cumulative solar radiation was measured by the
Illinois EPA at the Jardine air monitoring station. Solar
radiation data were not available for several days of
sampling because of an instrument malfunction. These
days were excluded from analysis.
Combined sewer overflow (CSO) variables were
defined for each CAWS location–day–hour at which
bacteria were measured using data reported by the
Metropolitan Water Reclamation District of Greater
Chicago to the Illinois EPA. Overflow (active or passive)
anywhere in a channel (North Branch or Cal-Sag
Channel) defined a CSO event for the channel.
CSO events were distinguished by ≥6 h without
CSO anywhere in a channel.
River flow (cubic feet per second) and stage (gauge
height, feet) data were obtained from the US Geological
Survey. For the North Branch locations, a downstream
gauge at Grand Avenue on the North Branch of the
Chicago River was used. For the Cal-Sag Channel locations, an upstream gauge on the Little Calumet River
was used. Lake Michigan stage (gauge height, feet) data,
measured at the Chicago Locks, were obtained from the
US Geological Survey (starting 9/15/2007) and used for
Lake Michigan locations. Hourly averages were calculated. The mean hourly flow varied between the North
Branch (mean flow0630 ft3/s) and Cal-Sag Channel



Author's personal copy
2358

Environ Monit Assess (2013) 185:2355–2366

Table 1 Variables in the data set
Variable

Description and units

density

The response variable. For bacteria, CFU per 100 mL. For coliphages,
PFU per 100 mL. For protozoan pathogens, (oo)cysts per 10 L

location

Locations in the North Branch (A–E) and Cal-Sag Channel (F–H)
influenced by effluent from the Northside and Calumet Water
Reclamation Plants. Location code, not distance from plant

last.rain

Time since last rainfall (h)

dur.last.rain

Duration of the last rainfall event (h). Rainfall events are
distinguished by ≥6 h without rain

mag.last.rain

Magnitude of the last rainfall event (in.)

int.last.rain

Intensity of the last rainfall event (in./h)

h12.rain

Cumulative rain in the 12 h prior to sample collection (in.)

h24.rain

Cumulative rain in the 24 h prior to sample collection (in.)

h48.rain

Cumulative rain in the 48 h prior to sample collection (in.)

h72.rain

Cumulative rain in the 72 h prior to sample collection (in.)

h96.rain

Cumulative rain in the 96 h prior to sample collection (in.)

rain.12.24

Cumulative rain in the >12–24 h prior to sample collection (in.)

rain.24.48

Cumulative rain in the >24–48 h prior to sample collection (in.)

rain.48.72

Cumulative rain in the >48–72 h prior to sample collection (in.)

rain.72.96

Cumulative rain in the >72–96 h prior to sample collection (in.)

cum.sun

Cumulative solar radiation on the day of sample collection, prior
to sample collection (Ly/min)

last.cso

Time since last CSO in North Branch or Cal-Sag Channel (h)

dur.last.cso

Duration of last CSO (h). CSO events are distinguished by ≥6 h
without CSO in North Branch or Cal-Sag Channel

mag.last.cso

Magnitude of the last CSO event (109 gal)

int.last.cso

Intensity of the last CSO event (109 gal/h)

last.cso2

Time since the penultimate CSO event in the North Branch or Cal-Sag
Channel (h)

dur.last.cso2

Duration of the penultimate CSO event (h)

mag.last.cso2

Magnitude of the penultimate CSO event (109 gal)

int.last.cso2

Intensity of the penultimate CSO event (109 gal/h)

cso.tot.h.24

Number of hours in the 24 h prior to sample collection with CSO (h)

cso.tot.h.48

Number of hours in the 48 h prior to sample collection with CSO (h)

cos.tot.h.96

Number of hours in the 96 h prior to sample collection with CSO (h)

h.cso

CSO active in North Branch or Cal-Sag Channel during sample
collection. 1 yes, 0 no

stage.std

Centered and standardized river or lake stages (ft) in the hour of
sample collection

flow.std

Centered and standardized river flow (ft3/s) in the hour of sample
collection

(mean flow0250 ft3/s), and the mean hourly stage
varied among all three locations: North Branch
(mean stage 0−2.16 ft), Cal-Sag Channel (mean
stage 06.69 ft), Lake Michigan (mean stage 0
−0.94 ft). Therefore, the flow and stage data were

centered and standardized for each location
category.
Variables known to be associated with microbial
density, but not used in the analysis in this study,
include water temperature, turbidity, and wave height.



Author's personal copy
Environ Monit Assess (2013) 185:2355–2366

Water temperature was not measured; turbidity was
inconsistently measured during sampling. No
near-shore buoys were available for wave height
measurements on Lake Michigan.
The data set for CAWS comprises 298 measurements
of each indicator bacterium (110 unique location–days),
with a detection frequency of 99 % for both E. coli and
enterococci. The data set for Lake Michigan comprises
117 measurements of each indicator bacterium (34
unique location–days), with a detection frequency of
95 % and 99 % for E. coli and enterococci, respectively.
Data analysis
All analyses were carried out using the R Project for
Statistical Computing. Regression trees were
implemented for each bacterium (log10 density) in
the CAWS using the complete suite of 29 variables
(Tables 1 and 2) and the function tree. For Lake
Michigan, because river flow and CSO-related variables
were not applicable, regression trees utilized 16
variables. A tenfold cross-validation (ten unique
90:10 splits) was utilized. The frequency with
which each variable appeared as a node variable in the
trees was tabulated across the ten training data
subsets. Prediction was evaluated by the coefficient of
determination on the validation data subsets (RV2) and
summarized by the mean and coefficient of variation
(CV) of the ten RV2 values.
Random forests with conditional inference trees
were implemented for each bacteria (log10 density) in
CAWS and Lake Michigan using the complete
variable suites (29 or 16 variables) and subsets of
the variables with the cforest function and control
cforest_unbiased. This method accommodates variable
correlation to minimize overfitting (Strobl et al. 2007;
Strobl et al. 2008; Strobl et al. 2009). Random forests
included 7,000 full regression trees generated from a
subsample of the data drawn without replacement. When
at least five variables were included, five variables were
selected at each node for testing (default value);
otherwise, all variables were selected for testing. Bacteria
log10 densities predicted by cforest are the unweighted
average values predicted by all 7,000 trees. Variable
importance was measured as the mean decrease
in accuracy (MDA) of the out-of-bag sample compared
to that obtained with permuted observations. Variables
with stronger predictive relationships show larger
decreases in model accuracy upon permutation. Variables

2359

were ranked based on MDA values for presentation.
Predictive performance was evaluated using the
coefficient of determination and root mean squared
prediction error (RMSPE) (Hou et al. 2006).
A tenfold cross-validation procedure was used to
evaluate random forest prediction in the stepwise variable
selection process. For other applications, the bagging
internal to the method was determined to be sufficient
to ensure stability in variable importance scores and
prediction.
Linear mixed effects (LME) models of log10 microbe
density were fit with the lme function and the maximum
likelihood method. Location served as a random
intercept effect to account for correlation in densities
within the same location. Selected variables were logtransformed to reduce skewness and improve correlation with the outcome variable, log10 bacterial density.
Cross-validation (unique 80:20 split) was used to validate predictive performance of models fitted to the
training data subset (80 %). Predictive performance in
the validation data set was summarized by the coefficient of determination (RV2). More extensive crossvalidation (e.g., tenfold) was not utilized because evaluating the stability in the LME coefficients was not a
primary study objective.
Models of indicator bacteria density in Lake Michigan were additionally evaluated against single sample
maximum standard for designated beach areas, 235E.
coliCFU/100 mL and 61 enterococci CFU/100 mL
(EPA 1986). Predictive performance relative to the
standard was defined by: (i) accuracy, the percent of
predictions that are true positives (in excess of threshold) or true negatives (less than or equal to the threshold); (ii) sensitivity, the percent of true positives that
are predicted positives; and (iii) specificity, the percent
of true negatives that are predicted negatives. These
comparisons were based on predicted values for the
ten training data subsets (tree models and random
forests) and training and validation data subsets for
LME models.

Results and discussion
Measured bacteria densities
Measured bacteria log10 densities are summarized in
Table S1 by location. Location A is physically upstream of the water reclamation plant but regularly



Author's personal copy
2360

Environ Monit Assess (2013) 185:2355–2366

Table 2 Tree regression node variables (number of times identified in the tenfold cross-validation) and performance in tenfold crossvalidation, and random forest variable importance, ranked by mean decrease in accuracy
Frequency of tree regression node variable identification

Random forest rank of mean accuracy decrease

CAWS

CAWS

Lake Michigan

Lake Michigan

Variable

E. coli

Entero

E. coli

Entero

E. coli

Entero

E. coli

Entero

location

10

10

10

10

1

1

1

1

last.rain

0

3

0

4

2

14

2

4

dur.last.rain

0

3

4

1

14

8

3

6

mag.last.rain

0

1

10

9

7

19

6

3

int.last.rain

0

0

4

1

11

22

8

5

h12.rain

0

0

3

0

29

27

14

15

h24.rain

1

10

0

0

21

5

13

14

h48.rain

10

0

6

0

10

12

7

11

h72.rain

0

1

2

2

5

16

10

10

h96.rain

0

3

3

0

9

20

11

9

rain.12.24

0

3

0

0

26

7

15

16

rain.24.48

0

0

1

0

22

23

9

12

rain.48.72

6

2

0

8

23

18

12

7

rain.72.96

1

1

1

1

24

24

5

8

cum.sun

10

1

7

4

12

25

16

13

stage.std

1

7

9

9

18

10

4

2

flow.std

6

4

a

a

25

17

a

a

5

a

a

2

a

a

0

a

a

9

a

a

3

a

a

6

a

a

a

16

13

a

a

4

3

a

a

15

a

a

11

a

a

4

a

a
a

last.cso
dur.last.cso
mag.last.cso

9
0
1

3
15
19

int.last.cso

5

0

a

last.cso2

10

10

a

a

0

a

a

6

a

a

5

a

a
a

27

29

a

20

26

a

a

21

a

a

28

28

a

a

R

0.655

0.591

0.668

0.663

RMSPE

0.583

0.477

0.672

0.663

dur.last.cso2
mag.last.cso2
int.last.cso2

9
0
0

cso.tot.h.24

0

0

a

cso.tot.h.48

0

1

a

a

0

a

a

0

a

a

cso.tot.h.96
h.cso

0
0

17
13
6

8

2

Mean RV2 (CV%)
a

0.596 (18 %) 0.430 (21 %) 0.515 (26 %) 0.594 (41 %)

Variable not included in analysis

receives the discharge plume owing to stagnation in
the waterway. For both bacteria, densities are generally
higher in the North Branch than in the Cal-Sag Channel
but do not decrease monotonically with distance from
the water reclamation plants. Average log10 bacteria

densities are greater at Lake Michigan beaches
than harbors. Of the 102 samples in Lake Michigan, 26 E. coli (25 %) and 34 (33 %) enterococcus samples exceed the single sample maximum
standard.



Author's personal copy
Environ Monit Assess (2013) 185:2355–2366

1.1
1.0
0.9
0.8
0.7
0.6

E. Coli - CAWS
entero - CAWS
E. coli - Lake MI
entero - Lake MI

0.5

R-squared Relative to Full Variable Random Forest

2

4

6

8

10

Number of Variables

0.8

1.0

1.2

1.4

b

E. Coli - CAWS
entero - CAWS
E. coli - Lake MI
entero - Lake MI

0.6

The frequency with which variables were identified as
node variables in the tree regression models is indicated
in Table 2. A value of 10 indicates that the variable was a
node variable in all ten training data subsets. For both
bacteria in the CAWS and Lake Michigan, four to eight
variables were identified in six or more of the trees fitted
to the training data subsets. These variables comprised
the majority (71–100 %) of node variables identified by
tree regression with the full data set (data not shown).
All variables identified as nodes in six or more of the
cross-validation tree models were included in subsequent LME models. While the four to eight variables
identified are of a number appropriate for linear statistical modeling of these data, this criterion may not provide sufficient data reduction in other contexts.
Random forests, in contrast, scores the importance
of each variable based on the MDA resulting from
conditional permutation of the variable. Variable rankings from random forests with the full variable suites
are presented in Table 2.
A forward-step selection process that introduced variables in order of decreasing importance rank (Table 2)
was used with random forests to evaluate how many
variables are needed to explain log10 bacteria densities.
At each forward-step, a tenfold cross-validation procedure was used to evaluate prediction based on R2 and
RMSPE. Boxplots representing the distribution of R2
and RMSPE across the validation data sets are available
in the supplementary materials (Figs. S2–S3); mean
values are plotted in Fig. 1. For enterococci in the
CAWS, the analysis indicates that one, two, and four
variables retain the most explanatory power (>90 %
relative to the full model R2) and have the lowest prediction error (RMSPE less than that in the full model). In
contrast, for E. coli in the CAWS and both bacteria in
Lake Michigan, explanatory power continues to increase and prediction error decreases with additional
variables. However, the rate at which performance
improves with the addition of more variables slows
when four or five variables are included, and again when
seven or more variables are included. However, >70 %
of explanatory power is retained relative to the full
variable models by the three most important variables.
Based on these results, we determined that LME models
of enterococci in the CAWS should incorporate the two
most important variables, while other LME models
should retain the three most important variables.

a

RMSPE Relative to Full Variable Random Forest

Data reduction by trees

2361

2

4

6

8

10

Number of Variables

Fig. 1 Performance of random forest models with forward-step
addition of variables in order of decreasing importance rank
(Table 2), relative to the full model with 29 (CAWS) or 16
(Lake Michigan) variables. a Comparisons by mean R2 from
tenfold cross-validation. b Comparisons by mean RMSPE from
tenfold cross-validation

Alternatively, backward-step variable selection processes may be used. In the context of genomic data,
Jiang et al. (2004) and Diaz-Uriarte and Alvarez de
Andres (2006) have successively implemented random forests with stepwise elimination of 10–20 % of
the least important variables. Backward-step selection
used by Jiang et al. (2004) is complementary to our



Author's personal copy
2362

approach because the initial variable rankings were
used to define the order of variable exclusion, whereas
Diaz-Uriarte and Alvarez de Andres (2006) recalculated variable rankings at each step. All of these investigators defined the optimum variable subset as that
which minimized the out-of-bag error rate. Svetnik et
al. (2004) found the out-of-bag error rate to be insensitive and recommended classification error rates or
mean squared error. As a result, we utilized R2 and
RMSPE.
Inspection of Table 2 shows that 38–75 % of node
variables in the tree models are also among the 40 %
highest random forest-ranked variables, but only the
first-ranked variable (location) is identified as a node
variable in all of the corresponding tree models. Of the
second-ranked variables, only that identified for enterococci in Lake Michigan (stage.std) is also a node
variable in the corresponding tree model. The fact that
the two techniques do not select identical variables
does not negate the approach. Neither method characterizes the true physical relationship between hydrometeorology and water quality, but rather identifies
associations with log10 bacterial density within the
constraints of their assumptions. Variability in variable
selection, therefore, should be expected. This is illustrated by the differences in tree node variables identified in the tenfold cross-validation (Table 2). By way
of analogy, backward-step and forward-step selection
processes in the fitting of linear regression models can
select different models that perform equally well, as a
result of influence of variable correlations and interactions during the selection process.
Numerous strategies are available for the selection of
variables in statistical models, but tree models remain
advantageous. In the context of linear regression models,
forward- and backward-step variable selection procedures can be implemented, but the approach is inconsistent in the context of LME models because these models
may not converge. In these data, for example, some
LME models with variables specified in Table 2 do not
converge. This means that a priori variable selection may
be required to initiate the stepwise procedure, and nonconvergence may arise at intermediate steps. Principal
component analysis has been suggested for these data
because the technique identifies a subset of orthogonal
components that explain the majority of variability in the
data. While regression modeling can proceed with a
manageable number of orthogonal components as predictor variables, the technique does not reduce the

Environ Monit Assess (2013) 185:2355–2366

dimensionality of the underlying data because each principal component is a linear function of all observed
variables. It is, therefore, difficult to infer which
observed variables are the best predictors.
Predictive performance of trees
The concordance between log10 bacteria densities
predicted by tree regression and random forests models
(fitted with the full variable suites) and measured values
was good, with RV2 0[0.430, 0.596] and R2 0[0.591,
0.668], respectively. The integration of random sampling in random forests provides an internal crossvalidation for the method.
While the theoretical development of random forests
indicates the technique is not subject to overfitting owing to the averaging of numerous trees (Breiman
2001b), in practice, the algorithm has been found to
overfit and to overestimate the importance of correlated
variables (Strobl et al. 2007; Auret and Aldrich 2011).
To address these concerns, we used conditional inference trees (Strobl et al. 2008, 2009). For these data, the
predictive performance of conditional inference trees
was more modest than conventional random forests
(e.g., as implemented by the function randomForests
by Liaw and Wiener (2002)), for which R2 >0.9.
The ability of the models to predict acceptable and
unacceptable water quality in Lake Michigan was
evaluated with reference to the single sample maximum (Table 3). Model predictions for all of the ten
validation data sets were evaluated in this analysis.
Both models had similar prediction accuracy (75–
86 %) and specificity (82–98 %) for both bacteria.
The sensitivity of the models to correctly identify the
event of unacceptable water quality was poor to
modest (27–65 %).
Predictive performance of linear models
Tree-based LME models were fitted to the training
data set using variables identified in at least six of
the cross-validated tree regressions. Forest-based
LME models were fitted with the two or three most
important variables (Table 4). Based on the AIC, LME
models that fit log-transformation of selected variables
were significantly better than models with nontransformed variables. Therefore, log-transformed variables
were utilized. Overall, residual distributions indicated
adequate performance of all LME models, although the



Author's personal copy
Environ Monit Assess (2013) 185:2355–2366

2363

Table 3 Predictive performance of Lake Michigan water quality
models against single sample maximum standard bacteria concentration, 235E. coliCFU/100 mL and 61 enterococci CFU/100 mL
Percent
LME regression modelsa
Tree
regressionb

Random
forest

Tree
regression
nodes

Random
forests
important

E. coli
Accuracy

75

78

77

77

Sensitivity

46

27

23

42

Specificity

86

96

77

89

Enterococci
Accuracy

87

76

72

76

Sensitivity

31

65

53

62

Specificity

98

82

80

84

a

Comparisons based on predictions for training and validation
data subsets, combined

b
Comparisons based on predictions for the ten validation data
subsets

variance and median values of residuals varied
somewhat by location (Figs. S4–S7).
Inspection of the AIC values (Table 4) suggests that
the tree-based LME models better characterize the
variability in bacterial density in the CAWS and
enterococcal density in Lake Michigan than forestbased LME models. This was confirmed by the loglikelihood test, for which p<0.001 for both bacteria in
the CAWS and for enterococci in Lake Michigan. In
contrast, for E. coli in Lake Michigan, the two LME
models performed similarly (p00.396).
Predictive performance of the LME models for the
validation data subset (RV2) was generally consistent
with that in the training data subset (R2, Table 4).
Evaluated with reference to the single sample maximum
standard (Table 3), both types of LME models have
similar accuracy (72–77 %) and specificity (77–
89 %). Sensitivity of the models was poor to modest
(23–62 %). These statistics are rarely calculated for
statistical models of microbial water quality, so comparisons of our approach are limited. However, a
real-time model of water quality in the Schuylkill
River had accuracy of 66 % in a validation data set,
with inaccuracies resulting from overestimation of
water quality hazards (Maimone et al. 2007).

More generally, the predictive performances of
models developed herein using readily available
hydrometeorological variables (Tables 2 and 4)
are similar to those of models developed through
more resource-intensive monitoring efforts. Linear
statistical models of E. coli and enterococcal densities
measured at Lake Michigan beaches had R2 values
ranging from 0.30 to 0.86 (Olyphant & Whitman
2004; Nevers & Whitman 2005; Telech et al 2009). In
addition to variables about rainfall, these models
included combinations of turbidity, wave height,
wind speed and direction, and water temperature.
All of these variables must be monitored at the
beach under study and may be cost prohibitive for
organizations responsible for the management of
numerous beaches. This result suggests that while
extensive monitoring may be required to understand the
physical processes that determine bacterial densities,
readily available data may be equally effective
for statistical prediction.
From the perspective of public health, correct identification of conditions posing elevated health risks
(sensitivity) may be more important than overall accuracy. The poor to modest sensitivity of the LME
models means that these statistical models should not
replace water quality monitoring at Chicago recreational waters until model sensitivity improves or is
found to be health-protective relative to routine
decision-making practices. Ultimately, this is a risk
management choice to be made by beach managers.
Predictors of microbial water quality
Location was consistently identified as an important
predictor of log10 bacteria density. Variation in water
quality across locations was directly apparent in the
data (Table S1). One measure of the relative variability
between locations in the LME models is a CV defined
by the ratio of the location random intercept effect
(standard deviation) and the intercept. Greater relative
variability is predicted across locations in Lake Michigan, where CV0[22 %, 275 %], than it is in the
CAWS, where CV0[9 %, 16 %]. The relatively small
variability in the CAWS makes physical sense owing
to the steady presence of wastewater discharge and
directional flow in that water body.
Rainfall may increase microbe densities by introducing microbes deposited onto surfaces via runoff,
inducing CSO, or other relevant mechanisms (Boehm



Author's personal copy
2364

Environ Monit Assess (2013) 185:2355–2366

Table 4 Coefficients for linear mixed effects models of log10 E. coli or enterococcal densities using variables selected based on tree
regression or random forests fitted to training data set and evaluated against validation data set (RV2)

Variable

Tree regression node variables

Random forests variable importance

CAWS

Lake Michigan

CAWS

Lake Michigan

E. coli

Entero

E. coli

Entero

E. coli

Entero

E. coli

Entero

0.49

0.24

0.43

0.66

0.44

0.29

0.53

0.73

3.1*

3.9*

1.5*

1.3*

4.0*

2.9*

2.04*

0.26*

Random effect (σ)
location
Fixed effect
Intercept

−0.11

ln(last.rain+1)

−0.18

*

*

−0.38*

ln(dur.last.rain)
−0.31*

ln(mag.last.rain)
ln(h24.rain+0.01)
ln(h48.rain+0.01)

0.10
0.10*
−0.02

cum.sun

−0.04

ln(last.cso+1)

−0.06

−0.13*

ln(last.cso2)

−0.04

0.02

0.26*
−0.11*

−0.10*

0.08*
0.01

ln(int.last.cso2)

0.06
0.01
−0.11

stage.std
AIC

−0.023

*

ln(mag.last.cso2)
flow.std

−0.20*

0.29*

ln(rain.48.72+0.01)

ln(dur.last.cso2)

−0.21*

*

521.4

376.4

0.03
189.7

0.07
186.2

0.10
536.0

406.9

187.6

195.9

R2

0.477

0.453

0.638

0.658

0.415

0.355

0.643

0.608

RV2

0.592

0.448

0.522

0.435

0.493

0.292

0.415

0.541

*

Coefficient p≤0.05

et al. 2007; Rijal et al. 2009). Rainfall- and/or CSOrelated variables were identified as node variables or
important variables in random forests (Table 2). The
modest R2 values for the LME models, particularly in
the CAWS where R2 <0.5, indicate that the models
may not reflect the underlying physical phenomena.
As a result, the magnitude and direction of the coefficients may be influenced by other variables and
should not be interpreted as quantifying cause and
effect relationships.
The specific rainfall variables identified as important to log10 bacteria density in this study include time
since and features of the last rainfall event prior to
sampling, and rainfall 0–24 h, 0–48 h, and 48–72 h
prior to sample collection (Table 2). Not all of these
variables achieved statistical significance when included in the LME models, however (Table 4). Other

investigators have utilized diverse rainfall variables,
spanning 4 to 72 h prior to sampling (Nevers & Whitman
2005; Maimone et al. 2007; Telech et al. 2009; Wilkes et
al. 2009). In aggregate, these data suggest that the appropriate rainfall metric(s) may be site-specific and that
multiday time windows should be considered. The diversity of potential rainfall variables motivates a datadriven variable selection procedure.
Cumulative solar radiation prior to the time of
sample collection was identified by tree regression as
an important variable for predicting log10 E. coli densities in Lake Michigan and the CAWS (Table 2).
Though the inactivation of sunlight has been found
to be stronger for enterococci than E. coli (Sinton et al.
2002; Noble et al. 2004), solar radiation was not
identified as an important variable for enterococci in
this study.



Author's personal copy
Environ Monit Assess (2013) 185:2355–2366

Conclusions
This research was motivated by the infrastructure and
personnel costs associated with many microbial water
quality studies, which gather extensive data to define
predictor variables for a few beaches. These costs limit
the number of beaches where monitoring can occur,
making statistical models inaccessible to many water
quality managers. We demonstrated that node variables
in tree regression models and importance-ranked variables in random forests can be the basis for variable
selection from a large suite of related variables. We also
demonstrated that hydrometeorological variables selected by these methods yielded simple LME models that
were able to predict the log10 density of fecal indicator
bacteria at sites of water recreation. The performance of
these models was similar to that seen in models based on
more extensive local environmental monitoring, suggesting that data-driven variable selection can identify
readily available hydrometeorological variables predictive of bacterial density. While our approach does not
explain the physical process by which environmental
factors influence bacterial water quality, it can be used at
a variety of locations for beach management decisionmaking. The LME models had good specificity but poor
sensitivity in predicting the exceedance of bacterial
water quality standards. Our models cannot be compared to the work of others using this metric, but it
suggests that statistical models will not always protect
the public from exposures to water with high densities of
indicator bacteria. Like all models for public health
decision-making, the performance of the method proposed herein should be evaluated for its public health
protection against current decision-making practices prior to adoption.
Acknowledgments We would like to acknowledge the
contributions of the CHEERS sample collection and data
management team, particularly, Mr. Ross Gladding, Dr.
Margit Javor, Ms. Chiping Nieh, Dr. Peter Scheff, and
Ms. Ember Vannoy. The map was created by Mr. Raja
Kaliappan. The CHEERS study was funded by the Metropolitan
Water Reclamation District of Greater Chicago.

References
Auret, L., & Aldrich, C. (2011). Empirical comparison of tree
ensemble variable importance measures. Chemometrics
and Intelligent Laboratory Systems, 105, 157–170.

2365
Boehm, A. B., Whitman, R. L., Nevers, M. B., Hou, D., &
Weisberg, S. B. (2007). Nowcasting recreational water
quality. In L. J. Wymer (Ed.), Statistical framework for
recreational water quality criteria and monitoring (pp.
179–210). Wiley: New York.
Breiman, L. (2001a). Statistical modeling, The two cultures.
Statistical Science, 16, 199–231.
Breiman, L. (2001b). Random forests. Machine Learning, 45,
5–32.
Diaz-Uriarte, R., & Alvarez de Andres, S. (2006). Gene selection and classification of microarray data using random
forest. BMC Bioinformatics, 7, 3. doi:10.1186/1471-210573-3.
Dorevitch, S., Pratap, P., Wroblewski, M., Hryhorczuk, D. O.,
Li, H., Liu, L. C., et al. (2012). Health risks of limitedcontact water recreation. Environmental Health Perspectives, 120, 192. doi:10.1289/ehp.1103934.
Dunkerley, D. (2008). Identifying individual rain events from
pluviograph records: a review with analysis from an Australian dryland site. Hydrologic Processes, 22, 5024–5036.
Edwards, P. J., Headley, A. S., Machin, F. H., & Scarr, A. M.
(2003). Factors affecting microbiological water quality at
sixteen beaches in South-West Wales. Journal of CIWEM,
17, 45–50.
Eleria, A., & Vogel, R. M. (2005). Predicting fecal coliform
bacterial levels in the Charles River, Massachusetts, USA.
Journal of the American Water Resources Association, 41,
1195–1209.
Frick, W. E., Ge, Z., & Zepp, R. G. (2008). Nowcasting and
forecasting concentrations of biological contaminants at
beaches: a feasibility and case study. Environmental
Science & Technology, 42, 4818–4824.
He, Y., Wang, J., Lek-Ang, S., & Lek, S. (2010). Predicting
assemblages and species richness of endemic fish in the
upper Yangtze River. Science of the Total Environment,
408, 4211–4220.
Hou, D., Ravinovici, S. J. M., & Boehm, A. B. (2006). Enterococci predictions from partial least squares regression models
in conjunction with a single-sample standard improve the
efficacy of beach management advisories. Environmental
Science & Technology, 40, 1737–1743.
Jiang, H., Deng, Y., Chen, H. S., Tao, L., Sha, Q., Chen, J., et al.
(2004). Joint analysis of two microarray gene-expression
data sets to select lung adenocarcinoma marker genes.
BMC Bioinformatics, 5, 81. doi:10.1186/1471-2105-5-81.
Kampichler, C., Wieland, R., Calme, S., Weissenberger, H., &
Arriaga-Weiss, S. (2010). Classification in conservation
biology: a comparison of five machine-learning methods.
Ecological Informatics, 5, 441–450.
Liaw, A., & Wiener, M. (2002). Classification and regression by
random forest. R News, 2(3), 18–22.
Maimone, M., Crockett, C. S., & Cesanek, W. E. (2007).
PhillyRiverCast: a real-time bacteria forecasting model and
web application for the Schuylkill River. Journal of Water
Resources, Planning & Management, 133, 542–549.
Nevers, M. B., & Whitman, R. L. (2005). Nowcast modeling of
Escherichia coli concentrations at multiple urban beaches
of southern Lake Michigan. Water Research, 39, 5250–
5260.
Nevers, M. B., & Whitman, R. L. (2008). Coastal strategies to
predict Escherichia coli concentrations for beaches along a



Author's personal copy
2366
35 km stretch of southern Lake Michigan. Environmental
Science & Technology, 42, 4454–4460.
Noble, R. T., Lee, I. M., & Schiff, K. C. (2004). Inactivation of
indicator micro-organisms from various sources of faecal
contamination in seawater and freshwater. Journal of Applied Microbiology., 96, 464–472.
Olyphant, G. A., & Whitman, R. L. (2004). Elements of a
predictive model for determining beach closures on a real
time basis: the case of 63rd Street beach Chicago. Environmental Monitoring & Assessment, 98, 175–190.
Parkhurst, D. F., Brenner, K. P., Dufour, A. P., & Wymer, L. J.
(2005). Indicator bacteria at five swimming beaches—
Analysis using random forests. Water Research, 39,
1354–1360.
Prasad, A. M., Iverson, L. R., & Liaw, A. (2006). Newer classification and regression tree techniques: bagging and random
forests for ecological prediction. Ecosystems, 9, 181–199.
Rijal, G., Petropoulou, C., Tolson, J. K., DeFlaun, M., Gerba,
C., Gore, R., et al. (2009). Dry and wet weather microbial
characterization of the Chicago Area Waterway System.
Water Science & Technology, 60, 1847–1855.
Roser, D. J., Davies, C. M., Ashbolt, N. J., & Morison, P. (2006).
Microbial exposure assessment of an urban recreational lake:
a case study of the application of new risk-based guidelines.
Water Science & Technology, 54, 245–252.
Schets, F. M., vanWijnen, J. H., Schijven, J. F., Schoon, H., & de
RodaHusman, A. M. (2008). Monitoring of waterborne
pathogens in surface waters in Amsterdam, the Netherlands,
and the potential health risk associated with exposure to
Cryptosporidium and Giardia in these waters. Applied Environmental Microbiology, 74, 2069–2078.
Sinton, L. W., Hall, C. H., Lynch, P. A., & Davies-Colley, R. J.
(2002). Sunlight inactivation of fecal indicator bacteria and
bacteriophages from waste stabilization pond effluent in
fresh and saline waters. Applied Environmental Microbiology,
68, 1122–1131.
Smith, A., Sterba-Boatwright, B., & Mott, J. (2010). Novel
application of a statistical technique, Random Forests, in
a bacterial source tracking study. Water Research, 44,
4067–4076.
Strobl, C., Boulesteix, A. L., Zeileis, A., & Hothorn, T. (2007).
Bias in random forest variable importance measures:

Environ Monit Assess (2013) 185:2355–2366
illustrations, sources and a solution. BMC Bionformatics,
8, 25. doi:10.1186/1471/2105-8-25.
Strobl, C., Boulesteix, A. L., Kneib, T., Hothorn, T., & Zeileis,
A. (2008). Conditional variable importance for random
forests. BMC Bioinformatics, 9, 307. doi:10.1186/14712105-9-307.
Strobl, C, Hothorn, T., & Zeileis, A. (2009) Party on! A new,
conditional variable importance measure for random forests
available in the party package. Technical Report Number
050, Department of Statistics, University of Munich.
Svetnik, V., Liaw, A., Tong, C., & Wang, T. (2004). Using
Breiman’s random forest to modeling structure–activity relationships of pharmaceutical molecules. Multiple classifier
systems, Fifth international workshop, MCS2004, proceedings, 9–11 June, 2004, Caligari, Italy. Lecture notes in computer science, Springer. 3007, 334-343.
Telech, J. W., Brenner, K. P., Haughland, R., Sams, E., Dufour,
A. P., Wymer, L., et al. (2009). Modeling enterococcus
densities measured by quantitative polymerase chain
reaction and membrane filtration using environmental
conditions at four Great Lakes beaches. Water Research, 43,
4947–4955.
US EPA. (1986). Ambient water quality criteria for beaches—
1986. EPA 440/5-84-002, http://water.epa.gov/scitech/
swguidance/standards/criteria/ health/recreation/ upload/
2009_04_13_beaches_1986crit.pdf. Accessed on April
12, 2011.
Wie, C. L., Rowe, G. T., Escobar-Briones, E., Boetius, A.,
Soltwedel, T., Caley, et al. (2010). Global patterns and
predictions of seafloor biomass using random forests. PLoS
ONE, 5, e15323. doi:10.1371/journal.pone.0015323.
Wilkes, G., Edge, T., Gannon, V., Jokinen, C., Lyautey, E.,
Medeiros, D., et al. (2009). Seasonal relationships among
indicator bacteria, pathogenic bacteria, Cryptosporidium
oocysts, Giardia cysts, and hydrological indices for surface
waters within an agricultural landscape. Water Research,
43, 2209–2223.
Wong, M., Kumar, L., Jenkins, T. M., Xagoraraki, I., Phanikumar,
M. S., & Rose, J. B. (2009). Evaluation of public health risks
at recreational beaches in Lake Michigan via detection of
enteric viruses and a human-specific bacteriological marker.
Water Research, 43, 1137–1149.

